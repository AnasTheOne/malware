import string


f = open("C:\\Users\\TechLab\\Desktop\\malware\\twofuncRelease.exe","rb")
#f = open("a.out","rb")




byte = f.read(1)
s = []

tre = lambda x: '%02x' % ord(x)

def imphex(L):
    s = ""
    for x in L:
        s += '%02x'%x
    return s

def check(L1,L2):
    if len(L1)!=len(L2):return False
    for i in range(len(L1)):
        if L1[i]!=L2[i]: return False
    return True

while byte != b"":
    s += [ord(byte)]
    byte = f.read(1)
print(5)
print(len(s),'%02x' % s[0],'%02x' % s[1],chr(s[0])+chr(s[1]))
D = [85,139,236]
S = [93,195]
cpt = 0
i = 0
while i < (len(s)-len(D)+1):
    if check(D,s[i:i+len(D)]):
        j = i
        i += len(D)
        while not check(D,s[i:i+len(D)]) and not check(S,s[i:i+len(S)]):
            i += 1
        if check(S,s[i:i+len(S)]):
            print('%02x'%(4198400+j),end = " ")
            print(imphex(s[j:i+len(S)]))
            cpt += 1
    """
    if check(S,s[i:i+len(S)]):
        print(s[i:i+30])
        cpt += 1
    """
    i+=1

print(cpt)

f.close()
